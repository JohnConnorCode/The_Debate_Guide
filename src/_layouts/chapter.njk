---
layout: base.njk
pageType: chapter
---
{% block styles %}
<link rel="stylesheet" href="{{ '/css/chapter.css' | url }}?v={{ build.timestamp }}">
<link rel="stylesheet" href="{{ '/css/chapter-illustrations.css' | url }}?v={{ build.timestamp }}">
<link rel="stylesheet" href="{{ '/css/quiz.css' | url }}?v={{ build.timestamp }}">
{% endblock %}

{% block progressBar %}
{# Reading Progress Bar #}
<div class="progress-bar">
    <div class="progress-bar-fill"></div>
</div>
{% endblock %}

{% block content %}
{# Breadcrumb Navigation #}
{% include "breadcrumbs.njk" %}

{# Chapter Hero #}
<section class="chapter-hero section-dark">
    {% include "sunburst.njk" %}

    <p class="chapter-part" data-animate>{{ partTitle }}</p>
    <div class="chapter-number" data-animate>{{ chapterNumber | padZero }}</div>
    <h1 class="chapter-title" data-animate>{{ chapterTitle | upper }}</h1>
    <p class="chapter-subtitle" data-animate>{{ subtitle }}</p>
    {% if readingTime %}<p class="reading-time" data-animate>{{ readingTime }}</p>{% endif %}
</section>

{% if chapterImage %}
<div class="chapter-image">
    <div class="image-container">
        <img src="{{ '/assets/illustrations/chapter-' + (chapterNumber | padZero) + '.svg' | url }}" alt="{{ chapterImageAlt or 'Art Deco illustration for Chapter ' + chapterNumber }}" loading="lazy" />
    </div>
</div>
{% endif %}

<div class="deco-border" data-animate="fade"></div>

{# Chapter Content - includes article, exercises, and navigation #}
<article class="section section-dark">
    {{ content | safe }}
</article>

{# Social Sharing #}
{% include "share-buttons.njk" %}

{# Chapter Quiz #}
{% include "quiz.njk" %}

<div class="deco-border" data-animate="fade"></div>
{% endblock %}

{% block extras %}
{# Keyboard Hint #}
<div class="keyboard-hint">
    {% if prevChapter %}<kbd>←</kbd> Previous{% endif %}
    {% if nextChapter %}<kbd>→</kbd> Next{% endif %}
    <kbd>Esc</kbd> Contents
</div>

{# Chapter Illustrations #}
<script src="{{ '/js/chapter-illustrations.js' | url }}?v={{ build.timestamp }}"></script>

{# TOC Discovery Hint #}
<script>
(function() {
    var tocHint = document.getElementById('toc-hint');
    var toolbar = document.querySelector('.reading-toolbar');
    var hasShownHint = sessionStorage.getItem('tocHintShown');

    if (!tocHint || !toolbar || hasShownHint) return;

    // Show hint when toolbar becomes visible
    var observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
            if (mutation.target.classList.contains('is-visible')) {
                // Show hint after a brief delay
                setTimeout(function() {
                    tocHint.classList.add('is-visible');
                    sessionStorage.setItem('tocHintShown', 'true');

                    // Hide after 4 seconds
                    setTimeout(function() {
                        tocHint.classList.remove('is-visible');
                    }, 4000);
                }, 1000);

                observer.disconnect();
            }
        });
    });

    observer.observe(toolbar, { attributes: true, attributeFilter: ['class'] });
})();
</script>
{% endblock %}
