/* ==========================================
   ANIMATION SYSTEM

   How it works:
   1. Elements with [data-animate] or .hero-animate start hidden (opacity: 0)
   2. JS adds .is-visible class to trigger animation
   3. CSS animation-delay creates stagger effect
   4. Animation uses forwards fill-mode to keep final state
   ========================================== */

/* ==========================================
   KEYFRAMES
   ========================================== */

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes scaleIn {
    from {
        opacity: 0;
        transform: scale(0.95);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

@keyframes expandWidth {
    from { width: 0; }
    to { width: 100%; }
}

@keyframes rotate {
    to { transform: rotate(360deg); }
}

/* ==========================================
   HIDDEN STATE
   No !important - animations need to override this
   ========================================== */

[data-animate] {
    opacity: 0;
    transform: translateY(20px);
}

.hero-animate {
    opacity: 0;
    transform: translateY(20px);
}

[data-animate="fade"] {
    transform: none;
}

[data-animate="scale"] {
    transform: scale(0.95);
}

/* ==========================================
   VISIBLE STATE - ANIMATION TRIGGERS
   Using original timing: 0.5s, cubic-bezier(0.43, 0.13, 0.23, 0.96)
   ========================================== */

[data-animate].is-visible {
    animation: fadeInUp 0.5s cubic-bezier(0.43, 0.13, 0.23, 0.96) forwards;
}

.hero-animate.is-visible {
    animation: fadeInUp 0.5s cubic-bezier(0.43, 0.13, 0.23, 0.96) forwards;
}

[data-animate="fade"].is-visible {
    animation-name: fadeIn;
}

[data-animate="scale"].is-visible {
    animation-name: scaleIn;
}

/* ==========================================
   HOMEPAGE HERO STAGGER (numbered classes)
   Uses .hero-animate-1, .hero-animate-2, etc.
   ========================================== */

.hero-animate-1.is-visible { animation-delay: 0ms; }
.hero-animate-2.is-visible { animation-delay: 120ms; }
.hero-animate-3.is-visible { animation-delay: 240ms; }
.hero-animate-4.is-visible { animation-delay: 360ms; }
.hero-animate-5.is-visible { animation-delay: 480ms; }

/* ==========================================
   CHAPTER HERO STAGGER
   Uses direct child selector for nth-child to work
   Sunburst is child 1 (no data-animate)
   Content elements are children 2-6
   ========================================== */

.chapter-hero > [data-animate]:nth-child(2).is-visible { animation-delay: 0ms; }
.chapter-hero > [data-animate]:nth-child(3).is-visible { animation-delay: 120ms; }
.chapter-hero > [data-animate]:nth-child(4).is-visible { animation-delay: 240ms; }
.chapter-hero > [data-animate]:nth-child(5).is-visible { animation-delay: 360ms; }
.chapter-hero > [data-animate]:nth-child(6).is-visible { animation-delay: 480ms; }

/* ==========================================
   TOC HERO STAGGER
   Homepage uses .hero-animate classes, not [data-animate]
   ========================================== */

.toc-hero .hero-animate-1.is-visible { animation-delay: 0ms; }
.toc-hero .hero-animate-2.is-visible { animation-delay: 120ms; }
.toc-hero .hero-animate-3.is-visible { animation-delay: 240ms; }
.toc-hero .hero-animate-4.is-visible { animation-delay: 360ms; }
.toc-hero .hero-animate-5.is-visible { animation-delay: 480ms; }

/* ==========================================
   TOC CHAPTER LIST STAGGER
   ========================================== */

.toc-chapters [data-animate]:nth-child(1).is-visible { animation-delay: 0ms; }
.toc-chapters [data-animate]:nth-child(2).is-visible { animation-delay: 60ms; }
.toc-chapters [data-animate]:nth-child(3).is-visible { animation-delay: 120ms; }
.toc-chapters [data-animate]:nth-child(4).is-visible { animation-delay: 180ms; }
.toc-chapters [data-animate]:nth-child(5).is-visible { animation-delay: 240ms; }
.toc-chapters [data-animate]:nth-child(n+6).is-visible { animation-delay: 300ms; }

/* ==========================================
   SECTION DIVIDERS
   ========================================== */

.section-divider[data-animate].is-visible .line {
    animation: expandWidth 0.5s ease-out forwards;
}

.section-divider[data-animate].is-visible .diamond {
    animation: scaleIn 0.4s ease-out 0.15s forwards;
}

/* ==========================================
   DECO BORDER
   ========================================== */

.deco-border[data-animate].is-visible {
    animation-name: fadeIn;
    animation-duration: 0.5s;
}

/* ==========================================
   SUNBURST - decorative only
   ========================================== */

.sunburst-hero svg {
    animation: rotate 600s linear infinite;
}

.chapter-hero .sunburst svg {
    animation: rotate 360s linear infinite;
}

/* ==========================================
   HOVER EFFECTS
   ========================================== */

.hover-lift {
    transition: transform 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.hover-lift:hover {
    transform: translateY(-3px);
}

.hover-glow {
    transition: box-shadow 0.25s ease-out;
}

.hover-glow:hover {
    box-shadow: 0 0 16px rgba(var(--color-gold-rgb), 0.25);
}

.hover-underline {
    position: relative;
}

.hover-underline::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 1px;
    background: var(--color-gold);
    transition: width 0.25s ease-out;
}

.hover-underline:hover::after {
    width: 100%;
}

/* ==========================================
   LOADING STATES
   ========================================== */

@keyframes shimmer {
    from { background-position: -200% 0; }
    to { background-position: 200% 0; }
}

.loading {
    position: relative;
    overflow: hidden;
}

.loading::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(var(--color-white-rgb), 0.1),
        transparent
    );
    animation: shimmer 2s infinite;
}

/* ==========================================
   PAGE TRANSITIONS
   ========================================== */

@keyframes pageEnter {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes pageExit {
    from { opacity: 1; }
    to { opacity: 0; }
}

.page-transition-enter {
    animation: pageEnter 0.25s ease-out forwards;
}

.page-transition-exit {
    animation: pageExit 0.2s ease-in forwards;
    pointer-events: none;
}

@view-transition {
    navigation: auto;
}

::view-transition-old(root) {
    animation: pageExit 0.2s ease-in;
}

::view-transition-new(root) {
    animation: pageEnter 0.25s ease-out;
}

/* ==========================================
   MOBILE - faster animations
   ========================================== */

@media (max-width: 768px) {
    [data-animate].is-visible,
    .hero-animate.is-visible {
        animation-duration: 0.4s;
    }

    .chapter-hero > [data-animate]:nth-child(3).is-visible { animation-delay: 100ms; }
    .chapter-hero > [data-animate]:nth-child(4).is-visible { animation-delay: 200ms; }
    .chapter-hero > [data-animate]:nth-child(5).is-visible { animation-delay: 300ms; }
    .chapter-hero > [data-animate]:nth-child(6).is-visible { animation-delay: 400ms; }

    .sunburst-hero svg,
    .chapter-hero .sunburst svg {
        animation: none;
    }

    .sunburst-hero {
        width: 500px;
        height: 500px;
        opacity: 0.03;
    }
}

@media (max-width: 480px) {
    [data-animate].is-visible,
    .hero-animate.is-visible {
        animation-duration: 0.35s;
    }

    @keyframes fadeInUpSmall {
        from {
            opacity: 0;
            transform: translateY(12px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    [data-animate].is-visible,
    .hero-animate.is-visible {
        animation-name: fadeInUpSmall;
    }

    [data-animate="fade"].is-visible {
        animation-name: fadeIn;
    }

    .sunburst-hero {
        display: none;
    }
}

/* ==========================================
   REDUCED MOTION
   Show content immediately, no animations
   ========================================== */

@media (prefers-reduced-motion: reduce) {
    [data-animate],
    .hero-animate {
        opacity: 1;
        transform: none;
    }

    [data-animate].is-visible,
    .hero-animate.is-visible {
        animation: none;
    }

    .sunburst-hero svg,
    .chapter-hero .sunburst svg {
        animation: none;
    }

    .hover-lift:hover {
        transform: none;
    }

    .section-divider[data-animate].is-visible .line,
    .section-divider[data-animate].is-visible .diamond {
        animation: none;
    }
}

/* ==========================================
   NO-JS FALLBACK
   ========================================== */

.no-js [data-animate],
.no-js .hero-animate {
    opacity: 1;
    transform: none;
}

/* ==========================================
   PRINT
   ========================================== */

@media print {
    [data-animate],
    .hero-animate {
        opacity: 1;
        transform: none;
        animation: none;
    }
}
